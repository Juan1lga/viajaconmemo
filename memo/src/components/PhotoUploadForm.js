import React, { useState, useEffect } from "react";import api from "../utils/api";import "./PhotoUploadForm.css";const PhotoUploadForm = ({ onClose }) => { const [title, setTitle] = useState(""); const [description, setDescription] = useState(""); const [file, setFile] = useState(null); const [album, setAlbum] = useState(""); const [albums, setAlbums] = useState([]); const [message, setMessage] = useState(""); const [error, setError] = useState(""); useEffect(() => { const fetchAlbums = async () => { try { const { data } = await api.get("/albums"); setAlbums(Array.isArray(data) ? data : []); } catch (err) { console.error("Error al obtener álbumes:", err?.response?.data?.msg || err.message); } }; fetchAlbums(); }, []); const handleSubmit = async (e) => { e.preventDefault(); if (!file) { setError("Por favor, selecciona un archivo."); setMessage(""); return; } try { const formData = new FormData(); formData.append("image", file); formData.append("title", title); formData.append("description", description); if (album) { formData.append("album", album); } await api.post("/photos/upload", formData, { headers: { "Content-Type": "multipart/form-data" } }); setMessage("Foto subida exitosamente. Pendiente de aprobación."); setError(""); setTitle(""); setDescription(""); setFile(null); setAlbum(""); if (typeof onClose === "function") { onClose(); } } catch (err) { setError("Error al subir la foto: " + (err?.response?.data?.msg || err.message)); setMessage(""); } }; return (<form className="upload-form" onSubmit={handleSubmit}> {message && <div className="notice success">{message}</div>} {error && <div className="notice error">{error}</div>} <div className="form-field"> <label htmlFor="title">Título</label> <input id="title" type="text" value={title} onChange={(e) => setTitle(e.target.value)} placeholder="Título de la foto" required /> </div> <div className="form-field"> <label htmlFor="file">Archivo</label> <input id="file" type="file" onChange={(e) => setFile(e.target.files[0])} accept="image/*" required /> </div> <div className="form-field"> <label htmlFor="album">Álbum</label> <select id="album" value={album} onChange={(e) => setAlbum(e.target.value)}> <option value="">Selecciona un álbum (opcional)</option> {albums.map((a) => (<option key={a._id} value={a._id}>{a.name}</option>))} </select> </div> <div className="form-field form-full"> <label htmlFor="description">Descripción</label> <textarea id="description" value={description} onChange={(e) => setDescription(e.target.value)} placeholder="Descripción (opcional)" rows={4}></textarea> </div> <div className="form-actions form-full"> <button type="submit" className="btn primary">Subir Foto</button> {typeof onClose === "function" && (<button type="button" className="btn" onClick={onClose}>Cancelar</button>)} </div> </form> );};export default PhotoUploadForm;